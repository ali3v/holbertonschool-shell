#!/usr/bin/env bash
# Creates PID file in /var/run, displays infinite messages, handles signals properly

cleanup() {
    rm -f /var/run/myscript.pid
    exit 0
}

# Create PID file with proper error handling
echo $$ > /var/run/myscript.pid 2>/dev/null || {
    mkdir -p /var/run 2>/dev/null
    echo $$ > /var/run/myscript.pid 2>/dev/null || {
        echo "Warning: Could not create PID file in /var/run" >&2
    }
}

# Set up signal handlers
trap 'echo "I hate the kill command"; cleanup' TERM
trap 'echo "Y U no love me?!"' INT
trap 'cleanup' QUIT

# Main loop
while true; do
    echo "To infinity and beyond"
    sleep 1
done
